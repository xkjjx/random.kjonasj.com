<head>
    <title>Nth Fibonacci</title>
    <style>
        * {
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<script type="module">
    import init, { fibonacci } from './pkg/nth-fibonacci/fibonacci_wasm.js';

    async function initWasm() {
        await init();
        window.calculateFibonacci = async function() {
            const button = document.getElementById("calculate-btn");
            const result = document.getElementById("result");
            
            // Disable button and show loading state
            button.disabled = true;
            result.innerHTML = "Calculating...";
            
            // Use setTimeout to allow UI to update before heavy calculation
            setTimeout(() => {
                const n = document.getElementById("n").value;
                const fibResult = fibonacci(parseInt(n));
                result.innerHTML = fibResult;
                button.disabled = false;
            }, 0);
        }
    }

    initWasm();
</script>

<body>
    <h1>Nth Fibonacci</h1>
    <p> This implementation uses WebAssembly instead of JavaScript to speed up the calculation.</p>
    <p> The calculation is done in the background, so the page will not freeze.</p>
    <p> See the source code for the WebAssembly section <a href="https://github.com/xkjjx/fibonacci-wasm">here</a> for more details.</p>
    <input type="number" id="n" placeholder="Enter a number">
    <button id="calculate-btn" onclick="calculateFibonacci()">Calculate</button>
    <p id="result" style="word-wrap: break-word;"></p>
    <p style="color:red">WARNING: Large numbers may slow/crash the page.</p>
</body>